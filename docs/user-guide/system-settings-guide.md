# RAG系统设置功能使用指南

本指南详细介绍如何使用RAG知识问答系统的设置功能，包括各种参数配置、模型设置等。

## 设置功能概述

RAG系统的设置功能位于主界面的"系统设置"标签页，提供了完整的系统配置管理界面。设置功能分为以下几个主要部分：

- **常规设置** - 系统基本参数配置
- **语言模型** - LLM模型配置和参数调整
- **嵌入模型** - 文档向量化模型配置
- **检索设置** - 文档检索和相似度匹配参数
- **存储配置** - 数据库和向量存储配置
- **高级设置** - 性能优化和调试选项

## 访问设置界面

1. 打开RAG系统主页面
2. 点击顶部导航栏的"系统设置"标签
3. 在左侧导航中选择要配置的设置类别

## 各设置类别详解

### 1. 常规设置

常规设置包含系统的基本配置参数：

#### 系统名称
- **作用**: 设置显示在页面标题和导航栏的系统名称
- **默认值**: "RAG知识问答系统"
- **使用建议**: 可以根据实际使用场景自定义名称

#### 默认语言
- **选项**: 简体中文、English、日本語
- **作用**: 设置系统界面的显示语言
- **默认值**: 简体中文

#### 最大文件大小 (MB)
- **范围**: 1-100 MB
- **作用**: 限制单个文档文件的上传大小
- **默认值**: 50 MB
- **使用建议**: 根据服务器性能和存储空间调整

#### 会话超时时间 (分钟)
- **范围**: 5-1440 分钟
- **作用**: 设置用户会话的自动超时时间
- **默认值**: 60 分钟
- **使用建议**: 平衡安全性和用户体验

#### 启用详细日志记录
- **作用**: 控制是否记录系统操作的详细日志
- **默认值**: 启用
- **使用建议**: 生产环境建议启用，便于问题排查

### 2. 语言模型设置

语言模型设置用于配置生成答案的大语言模型：

#### 模型提供商
支持的提供商包括：
- **OpenAI**: 使用GPT系列模型
- **SiliconFlow**: 国产大模型平台，支持中文优化
- **Ollama**: 本地部署的开源模型
- **Azure OpenAI**: 企业级OpenAI服务

#### 模型名称
根据选择的提供商，输入具体的模型名称：
- OpenAI: `gpt-4`, `gpt-3.5-turbo`, `gpt-4-turbo`
- SiliconFlow: `Qwen/Qwen2-7B-Instruct`, `Qwen/Qwen2-72B-Instruct`
- Ollama: `llama3`, `qwen`, `mistral`

#### API密钥
- **作用**: 访问模型服务的认证密钥
- **安全提示**: 密钥会以密码形式显示，确保安全性
- **获取方式**: 从对应提供商的官网获取

#### API基础URL
- **作用**: 模型服务的API端点地址
- **默认值**: 
  - OpenAI: `https://api.openai.com/v1`
  - SiliconFlow: `https://api.siliconflow.cn/v1`
- **使用场景**: 使用代理或私有部署时需要修改

#### 温度参数
- **范围**: 0.0 - 2.0
- **作用**: 控制生成文本的随机性和创造性
- **推荐值**:
  - 0.1-0.3: 需要准确、一致答案的场景
  - 0.7: 平衡准确性和多样性
  - 1.0-2.0: 需要创造性回答的场景

#### 最大令牌数
- **范围**: 100-4000
- **作用**: 限制单次生成的最大文本长度
- **默认值**: 1000
- **使用建议**: 根据应用需求和成本考虑调整

### 3. 嵌入模型设置

嵌入模型用于将文档转换为向量表示：

#### 嵌入模型提供商
支持的提供商：
- **OpenAI**: 高质量英文嵌入模型
- **SiliconFlow**: 中文优化的嵌入模型
- **Hugging Face**: 开源嵌入模型
- **本地模型**: 本地部署的嵌入模型

#### 嵌入模型名称
常用模型：
- OpenAI: `text-embedding-ada-002`, `text-embedding-3-small`
- SiliconFlow: `BAAI/bge-large-zh-v1.5`, `BAAI/bge-base-zh-v1.5`

#### 向量维度
- **作用**: 嵌入向量的维度大小
- **常见值**:
  - 768: 较小模型，速度快
  - 1024: 中等模型，平衡性能
  - 1536: 大模型，质量高

#### 文本块大小
- **范围**: 100-2000 字符
- **作用**: 文档分割时每个文本块的大小
- **默认值**: 1000
- **使用建议**: 根据文档类型和模型上下文长度调整

#### 文本块重叠
- **范围**: 0-500 字符
- **作用**: 相邻文本块之间的重叠部分
- **默认值**: 200
- **作用**: 确保重要信息不会在分割边界丢失

### 4. 检索设置

检索设置控制文档搜索和相似度匹配：

#### 检索文档数量 (Top-K)
- **范围**: 1-20
- **作用**: 每次检索返回的相关文档数量
- **默认值**: 5
- **使用建议**: 
  - 较小值(3-5): 提高响应速度
  - 较大值(8-15): 提高答案完整性

#### 相似度阈值
- **范围**: 0.0-1.0
- **作用**: 文档相似度的最低要求
- **默认值**: 0.7
- **使用建议**:
  - 0.8-0.9: 严格匹配，高精度
  - 0.6-0.7: 平衡精度和召回率
  - 0.4-0.5: 宽松匹配，高召回率

#### 搜索模式
- **选项**: 
  - 语义搜索: 基于向量相似度
  - 关键词搜索: 基于文本匹配
  - 混合搜索: 结合两种方式
- **默认值**: 语义搜索

#### 启用重排序
- **作用**: 对检索结果进行二次排序优化
- **默认值**: 启用
- **使用建议**: 建议启用以提高结果质量

#### 启用缓存
- **作用**: 缓存检索结果以提高响应速度
- **默认值**: 启用
- **使用建议**: 生产环境建议启用

### 5. 存储配置

存储配置管理数据库和向量存储：

#### 数据库类型
- **选项**: SQLite、PostgreSQL、MySQL
- **默认值**: SQLite
- **使用建议**: 
  - SQLite: 适合单机部署
  - PostgreSQL: 适合生产环境

#### 数据库连接URL
- **格式**: 
  - SQLite: `sqlite:///./rag_system.db`
  - PostgreSQL: `postgresql://user:password@host:port/database`
- **作用**: 数据库连接字符串

#### 向量存储类型
- **选项**: ChromaDB、Pinecone、FAISS
- **默认值**: ChromaDB
- **使用建议**: ChromaDB适合大多数场景

#### 向量存储URL
- **作用**: 向量数据库的连接地址
- **默认值**: 本地目录路径

#### 集合名称
- **作用**: 向量数据库中的集合名称
- **默认值**: "rag_documents"
- **使用建议**: 不同项目使用不同集合名称

### 6. 高级设置

高级设置包含性能优化和调试选项：

#### 最大并发请求数
- **范围**: 1-20
- **作用**: 同时处理的最大请求数量
- **默认值**: 5
- **使用建议**: 根据服务器性能调整

#### 请求超时时间 (秒)
- **范围**: 10-300
- **作用**: API请求的超时时间
- **默认值**: 60
- **使用建议**: 根据网络环境和模型响应时间调整

#### 缓存大小 (MB)
- **范围**: 100-2000
- **作用**: 系统缓存的最大大小
- **默认值**: 500
- **使用建议**: 根据可用内存调整

#### 日志级别
- **选项**: DEBUG、INFO、WARNING、ERROR
- **作用**: 控制日志记录的详细程度
- **默认值**: INFO
- **使用建议**: 
  - DEBUG: 开发调试时使用
  - INFO: 生产环境推荐
  - WARNING/ERROR: 只记录问题

#### 启用性能指标
- **作用**: 收集和显示系统性能指标
- **默认值**: 启用
- **使用建议**: 生产环境建议启用

#### 启用调试模式
- **作用**: 启用详细的调试信息
- **默认值**: 禁用
- **使用建议**: 仅在开发或故障排查时启用

## 设置操作指南

### 修改设置

1. 在左侧导航中选择要修改的设置类别
2. 在右侧表单中修改相应的参数值
3. 系统会自动检测更改并显示"有未保存的更改"提示
4. 点击"保存设置"按钮保存更改

### 验证设置

在保存设置前，系统会自动验证配置的有效性：
- **格式验证**: 检查输入格式是否正确
- **范围验证**: 检查数值是否在允许范围内
- **依赖验证**: 检查相关配置是否兼容

### 测试连接

对于模型和存储配置，可以使用"测试连接"功能：

1. 配置好相关参数
2. 点击"测试连接"按钮
3. 系统会尝试连接到配置的服务
4. 显示测试结果，包括连接状态、响应时间等

### 重置设置

如需恢复默认配置：
1. 点击"重置设置"按钮
2. 确认重置操作
3. 系统会将所有设置恢复为默认值

## 最佳实践建议

### 1. 配置优先级

建议按以下顺序配置系统：
1. 首先配置存储设置（数据库和向量存储）
2. 然后配置嵌入模型（用于文档处理）
3. 接着配置语言模型（用于问答生成）
4. 最后调整检索和高级设置

### 2. 性能优化

- **开发环境**: 使用较小的模型和参数以节省成本
- **测试环境**: 使用中等配置进行功能验证
- **生产环境**: 使用高质量模型和优化参数

### 3. 安全考虑

- 定期更换API密钥
- 不要在配置文件中硬编码敏感信息
- 使用环境变量管理敏感配置
- 定期备份配置设置

### 4. 监控和维护

- 启用日志记录和性能指标
- 定期检查系统健康状态
- 监控API使用量和成本
- 及时更新模型和配置

## 常见问题解决

### 1. 连接测试失败

**可能原因**:
- API密钥错误或过期
- 网络连接问题
- 服务提供商服务异常

**解决方法**:
- 检查API密钥是否正确
- 验证网络连接
- 查看服务提供商状态页面

### 2. 设置保存失败

**可能原因**:
- 配置验证失败
- 权限不足
- 系统错误

**解决方法**:
- 检查配置参数是否符合要求
- 查看错误提示信息
- 检查系统日志

### 3. 性能问题

**可能原因**:
- 参数配置不当
- 资源不足
- 网络延迟

**解决方法**:
- 调整并发数和超时时间
- 优化模型选择
- 启用缓存功能

通过合理配置这些设置，您可以根据具体需求优化RAG系统的性能和效果。建议在修改重要配置前先进行备份，并在测试环境中验证配置的有效性。